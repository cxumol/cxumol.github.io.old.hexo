title: 如果博客是一本书
categories: 拙计
description: ……那么，我愿把“如果”两字去掉
date: 2015-08-22 22:56:53
tags:
---


> ……那么，我愿把“如果”两字去掉

博客出书，不胜枚举:《暗时间》、《万万没想到》、《说服力》、《正版语文》……  
不严格的说，《明朝那些事儿》也算此列吧。

这些人写的文章，明明在网上公开发布过，又印成铅字，出版一遍。稿酬客观，居然买的人不少。简直人生赢家。

赘述这么多，其实都是废话。
本篇讨论的，是另一种博客成书——也就是某个**热心的**粉丝读者，把作者的网上文集**扒**下来，然后做成电子书的故事。

## 明确需求 

对于一个博客的老读者而言，[在线订阅](../atom.xml)最省心省力[^feed]。对于更新频繁的博客，更加管用，因为这样确保读者随时跟上进度。  

当然，如果只是随意浏览，新老之分毫无意义。博客原本就适用于游览式地看。  
事情总会发生变化。当我看到[李华治先生的博客](http://lihuazhi.com)，几篇文章读下来，越发觉得其叙事精彩，抒情悠长，评论痛快，文气充盈，文风对胃口。  
真想一口气全部读下来。

这不可能。时间本来就不属于每个人自己。慢慢看吧。  

博客系统按**日期先后**发表文章，如果要看最老的一篇，必须翻到最后一页。  
看到后面的文章时，每次都得翻页**很麻烦**。中断时，还必须 **自己记住进度**（读到的那一篇……是在第几页来着？）。  
我认为更好的方式，是从老文章读到新文章。顺流而下，也算历经一次作者成长的过程。但这不就得从最后一页翻到第一页吗……

况且，老夫已不再是当年那个*在电脑上看小说的*我了。如今早已习惯移动阅读——单独走路时，坐巴士时，拿起手机，都可以看，可谓省时不费事。

手机阅读，虽随时随地，仍有局限。譬如网络不稳，又如电量不多。联网时，电掉得快，可谓两相结合。

这样看来，最佳方案是**把博客做成电子书，手机上看**。  
来来来，数一数优点：

1. 制作时可以自定阅读顺序。从老文章一路看到新文章，很平滑
2. 同上，自定排版格式
3. 手机离线显示，省电
4. 阅读进度不会丢失

## 制定计划

- 扒文章
	- 分析每篇文章的网址，并下载网页
	- 分析网页结构，只把文章标题、日期、内容扣下来，其他的不要
	- 把扣下来的文章，分门别类的保存
- 转换成电子书
	- 选取合适的电子书格式，并用恰当的转换工具转换
	- 生成目录，设计排版
	- 扉页，作者信息一些可有可无的东西

## 不要怂，就是干

[<font color=#e51c23>前方乃一些枯燥无聊的技术细节，**点我跳过**，眼不见心不烦</font>](./#over)

### 扒文章

扒文章当然需要制作[爬虫](http://www.baike.com/wiki/%E7%88%AC%E8%99%AB%E7%A8%8B%E5%BA%8F)。制作爬虫当然[得用python](http://xiaoxia.org/2012/11/02/python-cralwer/)。用python当然得用miniconda发行版，和spyderIDE。哎呀，扯远了

python库多，任性。  
用哪个库？因为要联网，所以要urllib2；要读写文件，用os；还要分析网页结构，这个一会儿再说。哦，可以先透露一下，全部都是用的内置标准库哟。

**分析网址:** 这个文章地址啊，too simpile ! 不能更简单 。结构就是`http://lihuazhi.com/123`其中123换成随便一个什么正整数。开头简直顺利得……

**下载网页：** 没想到404等错误直接反馈给了urllib2.urlopen()，枉我分析404页特征一场空。另外得把以图片为主的两个分类排除掉，不下载

**分析内容：** 见过太多人吐槽*美汤*这个库又慢又不好使。于是我去看了看lxml和Xpath。很多人推荐很多人用，但中文资料不多，我这种渣能看懂的更少。勉强看官方文档，懂了一点。然后放弃了lxml。  
到头来，分析网页用的工具还是——re！正则表达式简单易懂！实乃居家旅行，xxxx 之必备良药，打遍天下都不怕不怕啦。用re分析，关键是懂得`.+?`和`gruop()`，不要漏了`re.S`(DOTALL模式)，其他请随意。  

**内容缓存：** 大蟒摸了这么久，数据结构却没用过几个。本来想用从前没用过的 dict 来存。但是*哥*发现了逼格更高的结构——类。很好哥也是写过面向对象的人了又一个从0到1的突破哈哈哈。既然确定了类为主体，除了用来存标题日期等的属性以外，不在旗下挂几个方法是说不过去的。于是有了 get() ，有了 save()。

**内容保存：** 这就是刚刚提到的 save() 干的活，其实没什么好说的。之前提取到了带标记含元素的`html`代码块，文件直接存为`%category%/yymm%title%.html`。别忘了如果目录不存在，还要额外写几行来建个目录。  
什么？听说作为`html`文件标准格式，前后要有`DOCTYPE!htmlheadbodyooxx`？真麻烦，不管了。没那些玩意的`html文件`照样能**在哥的浏览器里显示得好好的**。谁不服？请咬我！`赵日天你别、别、别过来`

> 到最后一个环节还真有家伙不服咬我了。我今天算是小小地埋了伏笔一下。

### 转epub
电子书当然要用epub格式的。这种格式，手机、kindle(越狱后)通杀，各种软件支持，排版格式神马丰富全面。  

**尝试一** github上找了个名叫"html2epub"的python脚本。试了一下，居然仅支持转换单文件夹的内容。每一个html都换成一个epub。没一点儿用`>_>`哼

**尝试二** 据说很神奇的`pandoc`。按照官方介绍的示例，[多个文件制epub](http://pandoc.org/epub.html#a-real-book)，依样画瓢。哦，还做了个脚本生成恶心的、折成很多行的命令行。运行……第一行就报错了。连官网的示例都报错。哼，没一点儿用`>_>`+1

穷则思变。哥这不是典型的用命令行用傻了吗。一门心思想着命令行工具耍起来威风凛凛，殊不知GUI界另有一番广阔天地。啊，又扯远。<sub>低头默讼：“装逼如风，常伴吾身。无形装逼，最为致命。”</sub>

**尝试三** 掌上书苑，国内业界知名站点，出了个制作器，叫epubbuilder。取名有范，看起来挺牛的。试看官方介绍：

> 书苑开发的ePub电子书制作神器，支持多国界面语言，支持unicode编辑，支持导入Txt、epub、Html、chm、snb等源文件；支持图文混排、音频、视频、多级目录等；方便快捷的界面；无需专业知识也可快速生成一本专业的电子书。

请注意第一句**神器**两个字。敢这么自称的，一般还真有两把刷子，比如：[赘述神器](http://www.zhuishushenqi.com/)  
国货当自强，就决定是您了！  
下载装好打开。居然要登陆？还好以老~~司机~~夫多年经验，眼尖发现了“离线”按钮，点一下，成功进入。界面上大大地摆着“未授权”。  
呃。没授权好像不影响使用吧。开工，批量导入html……然后！导入了乱码！

霎时没找到改编码的地方，这不重要。重要的是，“未授权”三个字依然在眼前晃来晃去。哼，没用的东西`>_>` 卸了。

卸归卸，<s> 装逼大业 </s>还是不能半途而废的。那么，有没有真正<s> 逼格高 </s>好用的epub制作工具？  

闲扯一句，到底哪种软件才能算highBger。全是洋文？NONONO！高逼格软件一般具有以下特征：

1. 免费
2. 开源
3. 跨平台
4. 小众

哦，不好意思，其实标准只有一个，也就是这个那个第四个。

**尝试四** 朋友，你听说过“sigil”吗？sigil完全符合前三项标准。<sub>至于第四项……不敢妄下断言</sub>  

sigil真的超好用，功能完善，支持中文。而且，你瞅这华丽的花体字，逼格满满<s>，让人单看图标也猜不到跟书有关 </s>，比某苑做的某*神器*不知道高到哪里去了。
![sigil](https://cloud.githubusercontent.com/assets/8279655/9424704/46e2e2f0-4928-11e5-9d4b-4292267d4aa5.png)

## 收工 {#over}

一些收尾细节  

> 目录、排版，随便搞一搞。目录用两级：文章分类一级，标题一级。    
封面，作者信息，扉页这种东西就真没必要了。因为反正只给自己看。（何不众乐乐？因为**版权啊版权**。没有经过作者授权，老夫是不会传播的）

俗话说:

> 现世报，来得快

下面这段话，照应了上面那个伏笔[^fubi]。  
粗制滥造的电子书只有**多看**能正确显示。（还好多看你没有抛弃我TT）  
请大家观赏效果图：[ 如果图片太大，请点击图片以看小图！ ]  
![](https://cloud.githubusercontent.com/assets/8279655/9424696/2433b932-4928-11e5-85c0-288508eacc50.png)
上图为：原本设定的排版

![anyview](https://cloud.githubusercontent.com/assets/8279655/9424698/24ad3dca-4928-11e5-995f-e54cd65b9a5b.png)
以上是anyview上的显示效果

![duokan](https://cloud.githubusercontent.com/assets/8279655/9424699/251b3b54-4928-11e5-9789-c147f7fd8848.png)
多看阅读

![moon+](https://cloud.githubusercontent.com/assets/8279655/9424700/251cd86a-4928-11e5-9548-461b189262a4.png)
静读天下 Moon+

接下来有请搞笑组登台亮相：  
![QD](https://cloud.githubusercontent.com/assets/8279655/9424701/26821f62-4928-11e5-8e1d-c6555fef3e62.png)
起点读书

![Yi](https://cloud.githubusercontent.com/assets/8279655/9424697/24773f68-4928-11e5-8688-47bfed107211.jpg)
网易云阅读



[^feed]: Google Reader 挂掉后，还有[不少替代方案](https://www.v2ex.com/t/71580)

[^fubi]: 人们说：“伏笔要伏得巧妙，切忌刻意、显露。”哈哈我这伏笔够巧妙够低调吧